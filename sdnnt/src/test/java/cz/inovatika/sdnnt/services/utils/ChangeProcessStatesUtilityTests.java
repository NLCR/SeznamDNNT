package cz.inovatika.sdnnt.services.utils;

import java.io.IOException;
import java.io.InputStream;
import java.util.Arrays;

import org.apache.commons.io.IOUtils;
import org.json.JSONArray;
import org.junit.Assert;
import org.junit.Test;

import com.fasterxml.jackson.core.JsonProcessingException;

import cz.inovatika.sdnnt.indexer.models.MarcModelTests;
import cz.inovatika.sdnnt.indexer.models.MarcRecord;

import static cz.inovatika.sdnnt.indexer.models.MarcModelTests.*;

public class ChangeProcessStatesUtilityTests {

    
    @Test
    public void testChangeStateNPA() throws IOException {
        MarcRecord marcRecord = MarcRecord.fromDocDep(prepareResultList("oai:aleph-nkp.cz:DNT01-000157317".replaceAll("\\:","_")).get(0));
        Assert.assertNotNull(marcRecord.datum_stavu);
        Assert.assertNotNull(marcRecord.dntstav);
        Assert.assertTrue(marcRecord.dntstav.size() == 1);
        Assert.assertTrue(marcRecord.dntstav.get(0).equals("PA"));
        Assert.assertTrue(marcRecord.historie_stavu.length() == 3);
        Assert.assertTrue(marcRecord.historie_stavu.getJSONObject(2).getString("stav").equals("N"));
        Assert.assertTrue(marcRecord.historie_kurator_stavu.length() == 3);
        Assert.assertTrue(marcRecord.historie_kurator_stavu.getJSONObject(2).getString("stav").equals("N"));
        
        ChangeProcessStatesUtility.changeProcessState("NPA", marcRecord,"Zmena stavu");
        Assert.assertTrue(marcRecord.dntstav.size() == 1);
        Assert.assertTrue(marcRecord.dntstav.get(0).equals("N"));
        Assert.assertTrue(marcRecord.historie_stavu.length() == 4);
        Assert.assertTrue(marcRecord.historie_stavu.getJSONObject(3).getString("stav").equals("N"));
        Assert.assertTrue(marcRecord.historie_kurator_stavu.length() == 4);
        Assert.assertTrue(marcRecord.historie_kurator_stavu.getJSONObject(3).getString("stav").equals("NPA"));
        
    }
    @Test
    public void testChangeStateD() throws IOException {
        MarcRecord marcRecord = MarcRecord.fromDocDep(prepareResultList("oai:aleph-nkp.cz:DNT01-000157317".replaceAll("\\:","_")).get(0));
        Assert.assertNotNull(marcRecord.datum_stavu);
        Assert.assertNotNull(marcRecord.dntstav);
        Assert.assertTrue(marcRecord.dntstav.size() == 1);
        Assert.assertTrue(marcRecord.dntstav.get(0).equals("PA"));

        ChangeProcessStatesUtility.changeProcessState("D", marcRecord, "Zmena stavu");
        Assert.assertTrue(marcRecord.dntstav.size() == 1);
        Assert.assertTrue(marcRecord.dntstav.get(0).equals("D"));
        Assert.assertTrue(marcRecord.kuratorstav.size() == 1);
        Assert.assertTrue(marcRecord.kuratorstav.get(0).equals("D"));
        
        Assert.assertTrue(marcRecord.historie_stavu.length() == 4);
        Assert.assertTrue(marcRecord.historie_stavu.getJSONObject(3).getString("stav").equals("D"));
        Assert.assertTrue(marcRecord.historie_kurator_stavu.length() == 4);
        Assert.assertTrue(marcRecord.historie_kurator_stavu.getJSONObject(3).getString("stav").equals("D"));
    }

    @Test
    public void testChangeStateDX() throws JsonProcessingException, IOException {
        MarcRecord marcRecord = MarcRecord.fromDocDep(prepareResultList("oai:aleph-nkp.cz:DNT01-000157317".replaceAll("\\:","_")).get(0));
        Assert.assertNotNull(marcRecord.datum_stavu);
        Assert.assertNotNull(marcRecord.dntstav);
        Assert.assertTrue(marcRecord.dntstav.size() == 1);
        Assert.assertTrue(marcRecord.dntstav.get(0).equals("PA"));

        ChangeProcessStatesUtility.changeProcessState("DX", marcRecord, "Zmena stavu");
        Assert.assertTrue(marcRecord.dntstav.size() == 1);
        Assert.assertTrue(marcRecord.dntstav.get(0).equals("PA"));
        Assert.assertTrue(marcRecord.kuratorstav.size() == 1);
        Assert.assertTrue(marcRecord.kuratorstav.get(0).equals("DX"));
        
        Assert.assertTrue(marcRecord.historie_stavu.length() == 4);
        Assert.assertTrue(marcRecord.historie_stavu.getJSONObject(3).getString("stav").equals("PA"));
        Assert.assertTrue(marcRecord.historie_kurator_stavu.length() == 4);
        Assert.assertTrue(marcRecord.historie_kurator_stavu.getJSONObject(3).getString("stav").equals("DX"));
    }
    
    
    @Test
    public void testChangeStatePAGranularity() throws JsonProcessingException, IOException {
        MarcRecord marcRecord = MarcRecord.fromDocDep(prepareResultList("oai:aleph-nkp.cz:DNT01-000157317".replaceAll("\\:","_")).get(0));
        marcRecord.granularity= new JSONArray("[{\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:ca76da30-dfa9-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"]}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:b21e43b0-f831-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1958\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:6c086a40-f827-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1959\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a131fd30-f831-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1960\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:95322d00-fdce-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1961\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:b6cedbc0-fdc9-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1962\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:6296c130-fdd3-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1963\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:67ca5a10-fdc7-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1964\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:af0694a0-fb6c-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1965\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:ac68bc70-fdd6-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1966\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:5347b5c0-1ab8-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1967\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:b77c7d70-fe64-11e2-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1968\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:2cdb3300-1629-11e3-a9a8-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1969\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:e5b5a0d0-162a-11e3-ae90-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1970\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:fc1dbe80-1386-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1971\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:083669d0-162d-11e3-ae90-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1972\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a53eb4f0-1603-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1973\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:8df1fd40-162e-11e3-bc65-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1974\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:eecacac0-116a-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1975\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:ff375f20-13c9-11e3-a9a8-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1976\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a789e310-0e24-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1977\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:4499f1f0-2bed-11e3-8d9d-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1978\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:91dbfb20-116c-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1979\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:845b3750-1387-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1980\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a8e16cb0-10a9-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1981\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:87469740-1ab5-11e3-bd38-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1982\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:6bf9e320-0e53-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1983\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:6586f400-04bd-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1984\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:8a347c90-0405-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1985\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a7d03380-2420-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1986\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:c1b94af0-08ac-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1987\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:3209a750-fda9-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1988\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:82074d50-04c2-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1989\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:7cf68e00-fb73-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1990\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:2ba5acf0-fff3-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1991\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:c6776b30-04ba-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1992\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:d2bf7500-fdca-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1993\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:589f7e40-ff6a-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1994\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:3c7823f0-0e17-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1995\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a8e51330-0e59-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1996\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:37b79290-0009-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1997\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:9879c3e0-1f6d-11e3-b62e-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1998\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:be2c01a0-fffd-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1999\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:1c414a30-1e98-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2000\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:140be4c0-0e16-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2001\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:b7837d00-fffe-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2002\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:1eda1680-040a-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2003\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:07e68ac0-0316-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2004\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:f9582020-fb6f-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2005\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:fcefae80-fb5e-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2006\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:f792fb21-f83b-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2007\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:81d82cc1-fb5b-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2008\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:64e7b710-fb57-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2009\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"34\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:2ba5acf0-fff3-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1991\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"36\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:d2bf7500-fdca-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1993\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"35\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:c6776b30-04ba-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1992\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"24\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a8e16cb0-10a9-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1981\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"18\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:eecacac0-116a-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1975\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"23\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:845b3750-1387-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1980\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"15\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:083669d0-162d-11e3-ae90-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1972\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"14\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:fc1dbe80-1386-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1971\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"21\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:4499f1f0-2bed-11e3-8d9d-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1978\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"26\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:6bf9e320-0e53-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1983\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"19\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:ff375f20-13c9-11e3-a9a8-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1976\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"33\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:7cf68e00-fb73-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1990\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"13\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:e5b5a0d0-162a-11e3-ae90-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1970\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"8\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:af0694a0-fb6c-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1965\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"7\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:67ca5a10-fdc7-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1964\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"5\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:b6cedbc0-fdc9-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1962\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"22\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:91dbfb20-116c-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1979\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"47\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:07e68ac0-0316-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2004\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"51\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:81d82cc1-fb5b-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2008\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"45\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:b7837d00-fffe-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2002\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"50\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:f792fb21-f83b-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2007\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"48\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:f9582020-fb6f-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2005\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"49\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:fcefae80-fb5e-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2006\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"44\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:140be4c0-0e16-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2001\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"46\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:1eda1680-040a-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2003\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"52\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:64e7b710-fb57-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2009\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"17\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:8df1fd40-162e-11e3-bc65-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1974\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"12\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:2cdb3300-1629-11e3-a9a8-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1969\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"16\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a53eb4f0-1603-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1973\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"41\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:9879c3e0-1f6d-11e3-b62e-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1998\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"40\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:37b79290-0009-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1997\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"25\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:87469740-1ab5-11e3-bd38-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1982\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"27\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:6586f400-04bd-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1984\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"28\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:8a347c90-0405-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1985\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"20\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a789e310-0e24-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1977\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"1\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:b21e43b0-f831-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1958\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"2\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:6c086a40-f827-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1959\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"3\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a131fd30-f831-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1960\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"6\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:6296c130-fdd3-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1963\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"10\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:5347b5c0-1ab8-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1967\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"11\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:b77c7d70-fe64-11e2-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1968\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"4\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:95322d00-fdce-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1961\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"42\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:be2c01a0-fffd-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1999\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"43\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:1c414a30-1e98-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2000\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"39\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a8e51330-0e59-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1996\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"38\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:3c7823f0-0e17-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1995\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"37\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:589f7e40-ff6a-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1994\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"9\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:ac68bc70-fdd6-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1966\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"29\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a7d03380-2420-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1986\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"30\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:c1b94af0-08ac-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1987\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"31\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:3209a750-fda9-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1988\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"32\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:82074d50-04c2-11e3-9923-005056827e52\",\"kuratorstav\":[\"PX\"],\"rocnik\":\"1989\"}]");
        
        ChangeProcessStatesUtility.changeProcessState("A", marcRecord, "Zmena stavu");

        Assert.assertTrue(marcRecord.dntstav.size() == 1);
        Assert.assertTrue(marcRecord.dntstav.get(0).equals("A"));
        Assert.assertTrue(marcRecord.kuratorstav.size() == 1);
        Assert.assertTrue(marcRecord.kuratorstav.get(0).equals("A"));
        
        JSONArray granularity = marcRecord.granularity;
        System.out.println(granularity);
    }

    @Test
    public void testChangeStateNGranularity() throws JsonProcessingException, IOException {
        MarcRecord marcRecord = MarcRecord.fromDocDep(prepareResultList("oai:aleph-nkp.cz:DNT01-000157317".replaceAll("\\:","_")).get(0));
        marcRecord.granularity= new JSONArray("[{\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:ca76da30-dfa9-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"]}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:b21e43b0-f831-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1958\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:6c086a40-f827-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1959\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a131fd30-f831-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1960\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:95322d00-fdce-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1961\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:b6cedbc0-fdc9-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1962\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:6296c130-fdd3-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1963\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:67ca5a10-fdc7-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1964\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:af0694a0-fb6c-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1965\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:ac68bc70-fdd6-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1966\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:5347b5c0-1ab8-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1967\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:b77c7d70-fe64-11e2-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1968\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:2cdb3300-1629-11e3-a9a8-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1969\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:e5b5a0d0-162a-11e3-ae90-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1970\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:fc1dbe80-1386-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1971\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:083669d0-162d-11e3-ae90-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1972\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a53eb4f0-1603-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1973\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:8df1fd40-162e-11e3-bc65-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1974\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:eecacac0-116a-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1975\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:ff375f20-13c9-11e3-a9a8-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1976\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a789e310-0e24-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1977\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:4499f1f0-2bed-11e3-8d9d-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1978\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:91dbfb20-116c-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1979\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:845b3750-1387-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1980\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a8e16cb0-10a9-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1981\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:87469740-1ab5-11e3-bd38-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1982\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:6bf9e320-0e53-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1983\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:6586f400-04bd-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1984\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:8a347c90-0405-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1985\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a7d03380-2420-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1986\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:c1b94af0-08ac-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1987\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:3209a750-fda9-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1988\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:82074d50-04c2-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1989\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:7cf68e00-fb73-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1990\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:2ba5acf0-fff3-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1991\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:c6776b30-04ba-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1992\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:d2bf7500-fdca-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1993\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:589f7e40-ff6a-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1994\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:3c7823f0-0e17-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1995\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:a8e51330-0e59-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1996\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:37b79290-0009-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1997\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:9879c3e0-1f6d-11e3-b62e-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1998\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:be2c01a0-fffd-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1999\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:1c414a30-1e98-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2000\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:140be4c0-0e16-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2001\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:b7837d00-fffe-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2002\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:1eda1680-040a-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2003\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:07e68ac0-0316-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2004\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:f9582020-fb6f-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2005\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:fcefae80-fb5e-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2006\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:f792fb21-f83b-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2007\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:81d82cc1-fb5b-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2008\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"link\":\"http://krameriusndk.nkp.cz/search/handle/uuid:64e7b710-fb57-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2009\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"34\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:2ba5acf0-fff3-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1991\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"36\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:d2bf7500-fdca-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1993\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"35\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:c6776b30-04ba-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1992\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"24\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a8e16cb0-10a9-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1981\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"18\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:eecacac0-116a-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1975\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"23\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:845b3750-1387-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1980\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"15\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:083669d0-162d-11e3-ae90-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1972\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"14\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:fc1dbe80-1386-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1971\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"21\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:4499f1f0-2bed-11e3-8d9d-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1978\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"26\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:6bf9e320-0e53-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1983\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"19\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:ff375f20-13c9-11e3-a9a8-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1976\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"33\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:7cf68e00-fb73-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1990\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"13\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:e5b5a0d0-162a-11e3-ae90-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1970\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"8\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:af0694a0-fb6c-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1965\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"7\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:67ca5a10-fdc7-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1964\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"5\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:b6cedbc0-fdc9-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1962\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"22\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:91dbfb20-116c-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1979\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"47\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:07e68ac0-0316-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2004\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"51\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:81d82cc1-fb5b-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2008\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"45\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:b7837d00-fffe-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2002\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"50\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:f792fb21-f83b-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2007\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"48\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:f9582020-fb6f-11e2-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2005\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"49\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:fcefae80-fb5e-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2006\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"44\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:140be4c0-0e16-11e3-9584-001018b5eb5c\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2001\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"46\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:1eda1680-040a-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2003\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"52\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:64e7b710-fb57-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2009\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"17\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:8df1fd40-162e-11e3-bc65-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1974\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"12\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:2cdb3300-1629-11e3-a9a8-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1969\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"16\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a53eb4f0-1603-11e3-8f8a-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1973\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"41\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:9879c3e0-1f6d-11e3-b62e-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1998\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"40\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:37b79290-0009-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1997\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"25\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:87469740-1ab5-11e3-bd38-5ef3fc9ae867\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1982\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"27\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:6586f400-04bd-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1984\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"28\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:8a347c90-0405-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1985\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"20\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a789e310-0e24-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1977\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"1\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:b21e43b0-f831-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1958\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"2\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:6c086a40-f827-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1959\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"3\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a131fd30-f831-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1960\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"6\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:6296c130-fdd3-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1963\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"10\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:5347b5c0-1ab8-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1967\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"11\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:b77c7d70-fe64-11e2-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1968\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"4\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:95322d00-fdce-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1961\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"42\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:be2c01a0-fffd-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1999\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"43\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:1c414a30-1e98-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"2000\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"39\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a8e51330-0e59-11e3-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1996\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"38\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:3c7823f0-0e17-11e3-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1995\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"37\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:589f7e40-ff6a-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1994\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"9\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:ac68bc70-fdd6-11e2-9439-005056825209\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1966\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"29\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:a7d03380-2420-11e3-a5bb-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1986\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"30\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:c1b94af0-08ac-11e3-beb8-005056827e51\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1987\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"31\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:3209a750-fda9-11e2-9923-005056827e52\",\"kuratorstav\":[\"PA\"],\"rocnik\":\"1988\"}, {\"stav\":[\"PA\"],\"license\":\"dnnto\",\"cislo\":\"32\",\"link\":\"https://kramerius.mzk.cz/search/handle/uuid:82074d50-04c2-11e3-9923-005056827e52\",\"kuratorstav\":[\"PX\"],\"rocnik\":\"1989\"}]");
        
        ChangeProcessStatesUtility.changeProcessState("N", marcRecord, "Zmena stavu");

        Assert.assertTrue(marcRecord.dntstav.size() == 1);
        Assert.assertTrue(marcRecord.dntstav.get(0).equals("N"));
        Assert.assertTrue(marcRecord.kuratorstav.size() == 1);
        Assert.assertTrue(marcRecord.kuratorstav.get(0).equals("N"));
        
        JSONArray granularity = marcRecord.granularity;
        System.out.println(granularity);
    }
}
