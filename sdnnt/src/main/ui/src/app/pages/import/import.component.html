<div class="app-container">  
  <ng-container>
    <div fxLayout="row" fxLayoutGap="32px" fxLayoutAlign="start center">
      <div fxFlex>
        {{ 'desc.num_found' | translate }}: <strong>{{ numFound }}</strong>
      </div>
      <div>
        <app-paginator [numFound]="numFound"></app-paginator>
      </div>
    </div>
    <div class="app-results-wrapper">
      <mat-card>
        <div fxLayout="row" fxLayoutGap="32px" fxLayoutAlign="start center">
          <div fxFlex>
            <strong class="app-mr-2">{{ 'desc.vysledek_importu' | translate }}:</strong>
            <span class="app-metadata">
              <ng-container *ngIf="date">{{ date | date : 'dd.MM.yyyy HH:mm' }}<span class="app-pipe"></span></ng-container>
              <ng-container *ngIf="uri">{{ uri }}<span class="app-pipe"></span></ng-container>
              <ng-container *ngIf="origin">{{ origin }}<span class="app-pipe"></span></ng-container>
            </span>
          </div>
          <div>
            <mat-slide-toggle [checked]="fullCatalog" (change)="fullCatalogChange($event)" class="app-mr-3">{{ 'desc.zobrazit_shody_z_celeho_katalogu_nejen_na_vyrazeni' | translate }} <span class="app-metadata">({{na_vyrazeni}})</span></mat-slide-toggle>
            <mat-slide-toggle [checked]="onlyNoEAN" (change)="onlyNoEANChange($event)" class="app-mr-3">{{ 'desc.zobrazit_jen_nepresne_shody' | translate }} <span class="app-metadata">({{noean}})</span></mat-slide-toggle>
            <mat-slide-toggle [checked]="onlyNoHits" (change)="onlyNoHitsChange($event)">{{ 'desc.zobrazit_nenalezene' | translate }} <span class="app-metadata">({{noHits}})</span></mat-slide-toggle>
          </div>
        </div>
      </mat-card>
      <ng-container *ngFor="let doc of docs">
        <mat-card>
          <mat-card-header>
            <mat-card-title fxLayoutAlign="unset" class="app-mb-0">
              <ng-container *ngIf="doc.name">
                <span class="app-text-cutter" [matTooltip]="doc.name" matTooltipPosition="below" style="max-width: 950px;">{{ doc.name }}</span>
                <span class="app-pipe"></span>
              </ng-container>
              <ng-container *ngIf="doc.author">{{ doc.author }}<span class="app-pipe"></span></ng-container>
              <ng-container *ngIf="doc.ean">{{ doc.ean }}<span class="app-pipe"></span></ng-container>
              <ng-container *ngIf="doc.num_hits">{{ doc.num_hits }}<span class="app-pipe"></span></ng-container>
              <ng-container *ngIf="doc.hit_type">{{ doc.hit_type }}<span class="app-pipe"></span></ng-container>
            </mat-card-title>
          </mat-card-header>
          <mat-card-actions *ngIf="doc.identifiers?.length > 0">
            <!-- <ng-container *ngFor="let id of doc.identifiers; let idx = index">
              <div *ngIf="fullCatalog || id.marc_990a.includes('A') || id.marc_990a.includes('PA')" fxLayout="row" fxLayoutGap="32px" [class.app-mt-1]="idx >= 1">
                <div fxFlex fxFlexAlign="flex-end">
                  <ng-container *ngIf="id.identifier"><a [href]="link(id.identifier)" target="_blank">{{ id.identifier }}</a><span class="app-pipe"></span></ng-container>
                  <ng-container *ngIf="id.nazev">{{ id.nazev }}<span class="app-pipe"></span></ng-container>
                  <ng-container *ngIf="id.marc_990a">{{ id.marc_990a }}<span class="app-pipe"></span></ng-container>
                  <ng-container *ngIf="id.ean">{{ id.ean }}<span class="app-pipe"></span></ng-container>
                </div>
                <div>
                <div *ngIf="id.approved" class="app-badge approved">
                  {{ id.approved ? ('desc.schvaleno' | translate) + ': ' +  id.approved_user : '' }}
                </div>
                <button mat-stroked-button *ngIf="!id.approved && (id.marc_990a.includes('A') || id.marc_990a.includes('PA'))" (click)="approve(doc, id.identifier)">
                  <mat-icon>done</mat-icon>
                  {{ 'desc.schvalit_zmenu_na_vyrazeni' | translate }}
                </button>
                </div>
              </div>
            </ng-container> -->
            <table class="app-table-import" [cellPadding]="0" [cellSpacing]="0">
              <tbody>
                <ng-container *ngFor="let id of doc.identifiers; let idx = index">
                  <tr *ngIf="fullCatalog || id.marc_990a.includes('A') || id.marc_990a.includes('PA')">
                    <td [class.approved]="id.approved">
                      <ng-container *ngIf="id.identifier"><a [href]="link(id.identifier)" target="_blank">{{ id.identifier }}</a><span class="app-pipe"></span></ng-container>
                      <ng-container *ngIf="id.nazev">{{ id.nazev }}<span class="app-pipe"></span></ng-container>
                      <ng-container *ngIf="id.marc_990a"><span [class]="id.marc_990a[0]">{{ id.marc_990a }}</span><span class="app-pipe"></span></ng-container>
                      <ng-container *ngIf="id.ean">
                        <span class="app-text-cutter" [matTooltip]="id.ean" matTooltipPosition="below" matTooltipClass="app-clean-truncated" style="max-width: 600px;">{{ id.ean }}</span>
                        <span class="app-pipe"></span>
                      </ng-container>
                    </td>
                    <td class="app-cell-action" [class.approved]="id.approved">
                      <ng-container *ngIf="id.approved">
                        {{ id.approved ? ('desc.schvaleno' | translate) + ': ' +  id.approved_user : '' }}
                      </ng-container>
                      <a *ngIf="!id.approved && (id.marc_990a.includes('A') || id.marc_990a.includes('PA'))" (click)="approve(doc, id.identifier)">
                        {{ 'desc.schvalit_zmenu_na_vyrazeni' | translate }}
                      </a>
                    </td>
                  </tr>
                </ng-container>
              </tbody>
            </table>
          </mat-card-actions>
        </mat-card>
      </ng-container>
    </div>
    <div class="app-mt-4">
      <app-paginator [numFound]="numFound"></app-paginator>
    </div>
  </ng-container>
</div>

